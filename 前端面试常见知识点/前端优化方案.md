# 前端优化方案

#### 一. 减少HTTP请求数
1. 合并文件（如：js，css）
2. 使用雪碧图 通过 background-image 和 background-postion 来显示不同部分
3. image map 合并多个图片，不推举使用

#### 二. 减少DNS查询
1. 通过缓存DNS查询来提高性能
2. 这种缓存可能发生在特定的缓存服务器，或者用户计算机
3. 减少DNS请求数可能会减少并行下载数。避免DNS查找减少响应时间，但减少并行下载数可能会增加响应时间。指导原则是组件可以分散在至少2个但不多于4个的不同域名。这是两者的妥协。

#### 三. 避免重定向
1. 浪费服务器资源

#### 四. 异步请求缓存
1.使用Accept-Encoding: gzip br等压缩技术
2.设置ETags（如何设置，后续更新）

#### 五. 延迟加载组件
1. 优化首屏加载速度
2. 提高性能，屏蔽掉一些不是必须加载的组件

#### 六. 预加载组件
1. 无条件预加载：一旦onload触发，你立即获取另外的组件。比如谷歌会在主页这样加载搜索结果页面用到的雪碧图。
2. 有条件预加载：基于用户动作，你推测用户下一步会去哪里并加载相应组件。
3. 预期的预加载：在发布重新设计（的网站）前提前加载。在旧网页预加载新网页的部分组件，那么切换到新网页时就不会是没有任何缓存了。

#### 七. 减少dom数
1. 尽量的减少dom，可以有效优化页面加载速度

#### 八. 不要404
1. 不要任何404(js,css,image等...), 404会浪费占用并行下载数
2. http请求非常昂贵，过多的404，会极大影响页面加载速度

#### 九. 使用CDN加速
1. 用户接近你的服务器会减少响应时间。把你的内容发布到多个，地理上分散的服务器可以让页面加载更快。
2. CDN是一群不同地点的服务器，可以高效的分发内容到用户

#### 十. 加Expires或者Cache-Control头部。
1. 对静态组件：通过设置Expires头部来实现“永不过期”策略。
2. 对动态组件：用合适的Cache-Control头部来帮助浏览器进行有条件请求。
3. 注意，如果你设置了Expires头部，当组件更新后，你必须更改文件名。

#### 十一. 传输时用gzip等压缩组件。
1. 从HTTP/1.1开始，客户端通过http请求中的Accept-Encoding头部来提示支持的压缩：
```Accept-Encoding: gzip, deflate```
2. 如果服务器看到这个头部，它可能会选用列表中的某个方法压缩响应。服务器通过Content-Encoding头部提示客户端：
```Content-Encoding: gzip```
3. gzip一般可减小响应的70%。尽可能去gzip更多（文本）类型的文件。html，脚本，样式，xml和json等等都应该被gzip，而图片，pdf等等不应该被gzip，因为它们本身已被压缩过，gzip它们只是浪费cpu，甚至增加文件大小。

#### 十二. 优化cookie
1. 消除不必要的cookie
2. 尽可能的减小cookie的大小，来优化响应时间
3. 设置cookie到合适的域名级别，使其他不需要cookie的子域名不受影响
4. 正确的设置Expries,时间短一些的Expries或者没有设置Expries可能会尽早的删除cookie,优化响应时间

#### 十三. 用没有cookie的域名来提供组件
1. 当浏览器请求静态图片并把cookie一起发送到服务器时，cookie此时对服务器没什么用处。
2. 所以这些cookie只是增加了网络流量。所以你应该保证静态组件的请求是没有cookie的。可以创建一个子域名来托管所有静态组件。
3. 比如，你域名是www.example.org，可以把静态组件托管在static.example.org。
4. 不过，你如果把cookie设置在顶级域名example.org下，这些cookie仍然会被传给static.example.org。这种情况下，启用一个全新的域名来托管静态组件。
3. 另外一个用没有cookie的域名提供组件的好处是，某些代理可能会阻止缓存待cookie的静态组件请求。

#### 十四. CSS放在HTMl顶部
1. 放在```<head>```标签中
2. 研究雅虎网页性能时发现把样式表移到```<head>```里会让页面更快。这是因为把样式表移到<head>里允许页面逐步渲染。
3. HTML规范清楚表明样式应该在 ```<head>``` 里。

#### 十五. 引入CSS时候 使用```<link>``` 而不是```@import```
1. 之前的一个最佳原则是说CSS应该在顶部来允许逐步渲染。
2. 在IE用@import和把CSS放到页面底部行为一致，所以最好别用。

#### 十六. 避免CSS表达式
1. CSS表达式的问题是它们可能比大多数人预期的计算的更频繁。
2. 它们不仅在页面载入和调整大小时重新计算，也在滚动页面甚至是用户在页面上移动鼠标时计算。比如在页面上移动鼠标可能轻易计算超过10000次。

#### 十七. 把js脚本放在底部
1. defer 会按照顺序在 DOMContentLoaded 前按照页面出现顺序依次执行。
2. async 则是下载完立即执行。
3. 两种都是并行下载

#### 十八. 使用外部js,css 和 压缩js,css
1. 方便缓存
2. 可压缩，加快加载速度

#### 十九. 减少DOM操作
1. 缓存访问过的元素的引用
2. 在DOM树外更新节点，然后添加到DOM树
3. 避免用JS实现固定布局

#### 二十. 再保证高清的同时，尽最大可能减少图片的质量
